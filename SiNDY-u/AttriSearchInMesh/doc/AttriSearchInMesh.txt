-------------------------------------------------------
	メッシュ内属性検索ツール使用法	2004/10/21 s_suzuki
-------------------------------------------------------

AttriSearchInMesh.exe [各種オプション] (> 進捗ログ)

【オプション】
■チェックするメッシュ関連オプション(いずれか必須)
    -l  <メッシュリスト>
    -m  <メッシュコード>

■ログ出力先オプション(必須)
    -o <出力ファイル名>

■その他任意のオプション
    -i  <出力フィールド設定ファイル> ... -c オプション指定時は無効
    -w  <Where句> ... 指定しなかったときは、「OBJECT IS NOT NULL」です
    -c     : メッシュ内のオブジェクト数を出力モード
    -nodup : カウントするとき、メッシュ境界上のポイントを考慮する(重複カウントされない)
             ※-nodup オプションは、現在SDE版でかつポイントデータのみ対応しています。\n"

・Where句指定方法についての注意(-w オプション)
※バッチファイルから実行時の Like条件指定時の注意点
    (1)SDEモードですと部分一致等で[%]を使うことがあると思いますが、
       バッチファイル上では、[%]は一つ記入だけだと無視してしまうので使用する時は必ず[%%]として下さい
       コマンドラインからであれば一つで大丈夫です。

       Ex)NAME_STRING1 like '%%塚'
          NAME_STRING1 like '_塚'	[_]は、一つで大丈夫です

	(2)SDEとPGDBモードでのワイルドカードの違い
       SDE  : [%][_]
       PGDB : [*][?]

【環境変数について】
    PGDB_MODE      SiNDY-c用チェックモード ON/OFF(何か設定されていれば、ONと判断する)
    DB_ANY         DB接続プロパティ(SDE PGDB供用)
    FC_TARGET      検索対象フィーチャクラス名
    FC_{CITY|BASE|MIDDLE}MESH  チェックするスケールに応じたメッシュフィーチャクラスを設定する


何も指定しない時は、ログハンドル形式の出力

【設定ファイルについて】(sample.iniを見てください)
    ・検索対象のフィーチャクラス名に属するフィールド名を正しく書いてください
      (※存在しないフィールドは、無視されます)
    ・#が行頭にあるときコメント行になります
    ・大文字・小文字どちらでも大丈夫です

【出力形式】

通常モードは、ログハンドルツール標準形式です

    ・情報1は、メッシュコード
    ・情報2〜n までに設定ファイルで明記したフィールドの順に値が出力されます
    ・ログヘッダーには設定したフィールドのエイリアス名が表示されます。
      Ex)NAME_STRING1・STRING_NUM1を指定した時
        … 注記文字列１  注記文字数１
        … 平塚市        6
        といった具合です。

    ・-c オプション指定時は、「メッシュコード<tab>件数」 の形式で出力されます。

【更新履歴】

2008/03/25	2.1.0.3
・[Bug5934] メモリ使用量が増え続ける問題に対応

2007/08/29	2.1.0.2
・メッシュポリゴンのメッシュコードフィールド統一に対応

2007/03/15	2.0.0.1
・SiNDY-c対応
・実行方法を大きく変更 … SiNDY-cでは、単メッシュ指定が必要のためオプション形式にした。
・出力フィールド設定ファイルの指定方法を環境変数 INIT_FILE からコマンドライン引数で指定するよう変更(-i オプション)
・指定したログが存在するときは、追記モードに変更(ヘッダーも出力されません)
・ポリゴンの場合のポイントを表示する際に、IArea::get_Centroid() → IArea::get_LabelPoint()に変更
・ラインの時は、先頭のポイントを表示するようにした(今までは表示してなかったので)
・出力フィールドの順を設定ファイルで記入した順になるよう修正(今までは、フィールドインデックス順でした)
・VC8対応

2006/08/04	1.2.0.4
・メッシュ境界上のオブジェクトの扱い方を変更(ポイントデータのみ対応)
(今まで)メッシュ境界上にあるとき、両方のメッシュにおいて出力していた
(これから)-nodupオプションを指定した際には、重複しないで出力するようにした
	→境界上にあるものは左隣or下隣or左下メッシュ内のオブジェクトでのみ扱うようにする
	→但し、メッシュリスト内に左隣or下隣or左下メッシュがないときは、当該メッシュで扱うようにする
	→-nodupオプションを指定しないときよりも若干処理時間はかかります

2005/09/20	1.1.1.3
・ポリゴンの場合には、センターポイントを表示するよう修正

2004/11/15	1.1.0.2
・属性検索に引っかかるメッシュ内オブジェクト数のみを出力する機能追加

2004/10/21	1.0.0.1
・新規作成
