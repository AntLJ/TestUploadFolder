TWN過去トラルール

■背景
0911末からTWN個別プロット対応を対応することとなり、通常の住所クレームと同様に
位置移動・属性変更がないかなどの過去トラ管理が必要。

■要望
CheckGPErrorのTelTP版を作成して欲しい。
(チェックモードのみで、更新モードは不要)

■詳細
クレームNo、ObjectID、シーケンスのみを指定した場合は存在確認・座標付与。
meshXYなどを指定した場合は位置・属性チェックなどを行う。


●入力形式(タブ区切り)
　クレームNo.(任意文字列)　ObjectID　シーケンス　MESH　X　Y　座標付与種別
　(クレームNo、ObjectID、シーケンスは必須)

●出力形式(タブ区切り)
　FLAG　クレームNo.　ObjectID　シーケンス　MESH　X　Y　座標付与種別　ユーザクレームフラグ　電話番号　掲載住所　住所コード　方書　掲載名称　調査結果コード　情報ソース　メッセージ　1:MESH　1:X　1:Y　COMMENT
　(電話番号や住所コードも出力するのは、そのままリリース資料に使用できるようにする為)

　　※座標付与種別(ADDXY_C)と調査結果コード(POINTSTAT_C)はコードのまま表示。


●チェック条件・メッセージ
　◆クレームNo.、ObjectID、シーケンスのみ指定した場合
　・シーケンスが存在する → 新規追加
　　※ADDXY_CはDBの情報を出力する。

　・シーケンスが存在しない　→ 【要確認】対象ポイントが存在しない

　◆mesh以降の指定がある場合
　(ADDXY_Cの指定が無いときは全て「1：クレーム」扱いとする)

　①シーケンスが存在しない
　　　→  【要確認】対象ポイントが存在しない

　②ADDXY_C=1 かつ POINTSTAT_C != 2 (クレーム対象なのに「該当施設あり」以外)
　　　→　【要確認】「該当施設あり」でない

　③ADDXY_Cが指定と違う (指定がない場合はクレーム扱い)
　　　→　【要確認】座標付与種別が違う
　　※ ログに出力されるADDXY_Cは入力で指定されたADDXY_Cのままでよい。

　④指定したmeshXYと違う
　　　→　【要確認】対象ポイント移動

※Bug8518で条件・メッセージ変更 2011/03/23
　⑤同じシーケンス、かつ同じ座標付与種別コードを持つTelTPポイントが複数存在する場合
　　　⇒　【要確認】同一シーケンス＆座標付与種別のTelTPポイントが複数ある

　⑥何らかの事情でTelTPポイントを見つけたが、情報が取得できない場合（用意されてるだけで、現状は発生しません。）
　　　⇒　【エラー】TelTPポイントの情報取得失敗

　⑦TelTPポイントのADDXY_Cが数値以外 or -1 が入っている場合(「【要確認】座標付与種別が違う」より優先されます）
　　　⇒　【エラー】ADDXY_C取得失敗

　・上記以外 
　　　→　問題なし

　※同一シーケンスが複数存在する場合
　　　⇒　メッセージの後に (同一シーケンス:AddXY_C<・・・ >) が追加される。


●エラーの優先順位
1つのオブジェクトに対して、複数のエラーがあっても、出力ファイルの仕様上、下記優先順位の通り、1つだけエラーが出ます。
優先順位を変更したい場合はBugzillaに登録してください。

①＞⑦＞⑤＞④＞③＞②

掲載住所の変更確認などは、インポート時にフォローしてもらうので、チェック項目としては加えていません。

